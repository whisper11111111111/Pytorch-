# PyTorch手写数字识别系统

这是一个基于PyTorch实现的MNIST手写数字识别系统，包含命令行训练工具和图形用户界面应用程序。系统能够训练卷积神经网络模型、评估模型性能，以及预测用户提供的手写数字图片。

## 系统组件

本系统包含以下两个主要组件：

1. **训练和命令行预测工具 (`mnist.py`)**
   - 用于训练神经网络模型
   - 提供命令行方式的图片预测功能
   - 生成训练过程的可视化图表

2. **图形用户界面应用 (`mnist_gui.py`)**
   - 提供友好的图形界面
   - 支持上传图片进行识别
   - 实时显示处理过程和识别结果

## 模型架构

系统使用的卷积神经网络(CNN)架构如下：

- **输入层**：28x28像素的灰度图像
- **第一卷积块**：
  - 16个3x3卷积核
  - ReLU激活函数
  - 2x2最大池化
- **第二卷积块**：
  - 32个3x3卷积核
  - ReLU激活函数
  - 2x2最大池化
- **全连接层**：
  - 32*7*7 → 128个神经元
  - ReLU激活函数
  - 0.5概率的Dropout
- **输出层**：10个神经元(对应数字0-9)

## 安装要求

在运行系统前，请确保已安装以下Python库：

```bash
pip install torch torchvision matplotlib numpy pillow PyQt5
```

## 使用方法

### 1. 训练模型

要训练模型，请在命令行中运行以下命令：

```bash
python mnist.py --mode train
```

训练过程将产生以下输出文件：
- `best_mnist_model.pth` - 训练得到的最佳模型
- `training_curves.png` - 训练和测试损失/准确率的可视化图表
- `prediction_examples.png` - 模型预测示例

### 2. 使用GUI应用程序进行预测

要启动GUI应用程序识别手写数字，请运行：

```bash
python mnist_gui.py
```

或者双击`start_recognizer.bat`文件（Windows系统）。

GUI应用程序使用说明：
1. 点击"上传图片"按钮选择一张手写数字图片
2. 点击"识别图片"按钮进行识别
3. 查看识别结果弹窗和处理后的图像
4. 使用"清除图片"按钮可以清除当前图片并上传新的图片

## 数据集

系统使用经典的MNIST手写数字数据集进行训练：
- 60,000张训练图像
- 10,000张测试图像
- 每张图像为28x28像素的灰度图

数据集自动下载到`./data/MNIST`目录下。

## 图像预处理

系统对输入的手写数字图片进行如下处理：
1. 转换为灰度图像
2. 增强对比度
3. 自动反转颜色（适应白底黑字或黑底白字）
4. 调整大小为28x28像素
5. 归一化处理

## 训练参数

- **批次大小**：64
- **学习率**：0.001
- **最大训练轮数**：10
- **优化器**：Adam
- **损失函数**：CrossEntropyLoss
- **早停机制**：5轮不改善则停止训练

## 注意事项

- 确保训练后的模型文件`best_mnist_model.pth`存在于指定路径
- 输入图像应当包含清晰的单个数字
- 图像应当有足够的对比度（深色数字，浅色背景或反之）
- 系统支持常见图像格式：JPG, PNG, BMP等

## 自定义图片测试

您可以将自己的手写数字照片放在项目目录中，通过GUI应用进行识别。为获得最佳效果：
- 确保数字在图像中居中
- 使用黑色笔在白色纸上书写（或反之）
- 避免图像中出现其他干扰元素

## 故障排除

问题：无法加载模型
> 解决：确保已经运行过训练模式`python mnist.py --mode train`

问题：图像识别结果不准确
> 解决：尝试调整图像对比度，确保数字在图像中清晰可见且居中

问题：GUI启动失败
> 解决：确认已安装PyQt5库`pip install PyQt5`
